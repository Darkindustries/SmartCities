from machine import Pin, I2C
from utime import sleep
from dht20 import DHT20
from lcd1602 import LCD1602

# --- Initialisation I2C ---
# LCD1602 sur I2C1
i2c_lcd = I2C(1, scl=Pin(7), sda=Pin(6), freq=400000)
lcd = LCD1602(i2c_lcd, 2, 16)
lcd.display()
lcd.clear()

# DHT20 sur I2C0
i2c_dht = I2C(0, scl=Pin(1), sda=Pin(0), freq=400000)
dht20 = DHT20(i2c_dht)

# --- Vérification des périphériques I2C ---
print("LCD devices:", i2c_lcd.scan())    # ex: [39]
print("DHT20 devices:", i2c_dht.scan()) # ex: [56]

# --- Boucle principale ---
while True:
    temper = dht20.dht20_temperature()
    humi = dht20.dht20_humidity()
    
    print("Temperature:", temper, "C")
    print("Humidity:", humi, "%")
    
    lcd.clear()
    lcd.setCursor(0, 0)
    lcd.print("Temp: " + str(temper) + "C")
    lcd.setCursor(0, 1)
    lcd.print("Hum: " + str(humi) + "%")
    
    sleep(2)
